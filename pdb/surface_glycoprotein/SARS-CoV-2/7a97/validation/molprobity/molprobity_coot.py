# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('D', ' 322 ', 'ASN', 0.014093477712709286, (259.2249999999999, 251.856, 347.0770000000001))]
data['omega'] = [('D', ' 146 ', 'PRO', None, (258.2999999999999, 237.089, 382.58)), ('E', ' 146 ', 'PRO', None, (355.685, 300.774, 353.9780000000001))]
data['rota'] = [('A', ' 164 ', 'ASN', 0.194117595923319, (233.34900000000007, 284.9990000000001, 317.603)), ('B', '  18 ', 'LEU', 0.12381370837139238, (326.054, 234.83500000000006, 305.63300000000004)), ('B', ' 331 ', 'ASN', 0.06300968836699868, (317.78, 298.369, 278.8320000000001)), ('B', ' 332 ', 'ILE', 0.03951771211700224, (318.446, 300.323, 282.092)), ('B', ' 336 ', 'CYS', 0.15280172066942035, (318.453, 307.266, 290.918)), ('B', ' 738 ', 'CYS', 0.058293302589806605, (263.817, 264.568, 271.949)), ('C', '1050 ', 'MET', 0.28522853334181947, (282.347, 271.065, 217.17600000000004)), ('D', ' 318 ', 'VAL', 0.003150532575091347, (252.317, 259.933, 350.256)), ('E', ' 252 ', 'TYR', 0.09610121486088419, (359.53999999999996, 283.415, 374.588)), ('E', ' 512 ', 'PHE', 0.19032966022237768, (333.4709999999999, 300.826, 359.9210000000001))]
data['cbeta'] = [('A', ' 743 ', 'CYS', ' ', 0.4555505124370843, (270.002, 294.905, 270.2220000000001))]
data['probe'] = [(' D 419  LYS  HA ', ' D 424  LEU  CD2', -1.583, (236.791, 252.535, 356.04)), (' D 233  ILE HD11', ' D 581  VAL  CG2', -1.483, (254.688, 270.57, 375.697)), (' D 320  LEU  CD2', ' D 555  PHE  HD2', -1.4, (261.651, 258.976, 351.9)), (' E 233  ILE HD11', ' E 581  VAL  CG2', -1.394, (329.295, 283.844, 362.436)), (' D 419  LYS  CA ', ' D 424  LEU HD22', -1.386, (237.934, 252.516, 356.09)), (' A  97  LYS  CE ', ' A 187  LYS  HE3', -1.362, (208.465, 277.711, 285.079)), (' A  97  LYS  HD2', ' A 185  ASN  O  ', -1.278, (210.447, 275.977, 285.155)), (' D 320  LEU  CD2', ' D 555  PHE  CD2', -1.203, (261.794, 259.719, 351.07)), (' D 320  LEU HD22', ' D 555  PHE  CD2', -1.197, (262.285, 259.275, 351.089)), (' A  97  LYS  HE3', ' A 187  LYS  CE ', -1.109, (209.002, 278.906, 284.422)), (' D 233  ILE HD11', ' D 581  VAL HG22', -1.107, (253.925, 271.042, 376.122)), (' E 233  ILE HD11', ' E 581  VAL HG21', -1.081, (328.389, 284.196, 363.774)), (' E 233  ILE HD11', ' E 581  VAL HG22', -1.062, (328.522, 282.871, 363.211)), (' D 320  LEU HD22', ' D 555  PHE  HD2', -1.055, (262.388, 258.887, 352.619)), (' D 233  ILE HD11', ' D 581  VAL HG21', -1.053, (255.013, 271.679, 377.094)), (' D 233  ILE  CD1', ' D 581  VAL  CG2', -1.048, (254.298, 270.414, 376.909)), (' E 233  ILE  CD1', ' E 581  VAL HG21', -1.017, (329.643, 284.521, 363.788)), (' E 233  ILE  CD1', ' E 581  VAL  CG2', -0.954, (329.789, 284.316, 363.39)), (' A  97  LYS  HE3', ' A 187  LYS  HE3', -0.944, (208.084, 278.789, 284.794)), (' D 423  LEU  O  ', ' D 423  LEU HD12', -0.926, (239.601, 246.304, 358.306)), (' D 419  LYS  CA ', ' D 424  LEU  CD2', -0.909, (237.453, 252.812, 355.894)), (' B 599  THR HG22', ' B 608  VAL  CG1', -0.904, (302.972, 251.031, 255.891)), (' D 419  LYS  HA ', ' D 424  LEU HD23', -0.901, (236.99, 251.783, 356.007)), (' D 233  ILE  CD1', ' D 581  VAL HG21', -0.891, (255.313, 270.531, 377.611)), (' D 233  ILE HD11', ' D 581  VAL HG23', -0.873, (255.36, 270.309, 375.919)), (' A  97  LYS  CD ', ' A 185  ASN  O  ', -0.857, (209.502, 276.141, 286.157)), (' D 419  LYS  HG2', ' D 424  LEU HD21', -0.837, (236.032, 253.746, 357.705)), (' A  97  LYS  HE2', ' A 187  LYS  HE3', -0.808, (207.965, 278.611, 286.361)), (' B 599  THR HG22', ' B 608  VAL HG12', -0.776, (302.435, 250.623, 255.434)), (' A  97  LYS  CE ', ' A 187  LYS  CE ', -0.756, (208.087, 279.213, 285.633)), (' E 233  ILE  CG1', ' E 581  VAL HG21', -0.732, (329.386, 284.729, 364.536)), (' A  97  LYS  HG3', ' A 187  LYS  HG3', -0.717, (210.785, 278.292, 285.252)), (' B 599  THR HG22', ' B 608  VAL HG11', -0.708, (302.713, 250.989, 257.084)), (' A  22  THR  OG1', ' A  76  THR  O  ', -0.705, (212.985, 260.56, 302.207)), (' D 229  THR  O  ', ' D 233  ILE HG12', -0.702, (256.499, 271.875, 378.868)), (' D 320  LEU HD21', ' D 555  PHE  HD2', -0.7, (261.895, 260.294, 352.87)), (' D 320  LEU  CD1', ' D 380  GLN  HB3', -0.697, (261.117, 256.193, 354.011)), (' A1068  VAL HG13', ' B 891  GLY  HA2', -0.69, (250.358, 255.456, 223.115)), (' C 106  PHE  HB2', ' C 117  LEU  HB3', -0.677, (298.724, 321.301, 282.234)), (' D 423  LEU  CD1', ' D 423  LEU  O  ', -0.662, (240.153, 246.094, 358.573)), (' B1047  TYR  HB2', ' B1067  TYR  HB3', -0.655, (277.007, 251.515, 218.809)), (' D 419  LYS  HA ', ' D 424  LEU HD22', -0.652, (238.16, 251.7, 357.602)), (' A1047  TYR  HB2', ' A1067  TYR  HB3', -0.651, (254.092, 261.543, 219.779)), (' A 744  GLY  C  ', ' A 746  SER  H  ', -0.644, (266.918, 298.828, 273.226)), (' D 233  ILE  CD1', ' D 581  VAL HG22', -0.642, (253.9, 270.59, 376.656)), (' D 320  LEU HD12', ' D 380  GLN  HB3', -0.638, (260.851, 256.138, 354.242)), (' B 440  ASN  C  ', ' B 442  ASP  H  ', -0.628, (333.272, 309.238, 312.156)), (' B 541  PHE  O  ', ' B 542  ASN  OD1', -0.627, (307.157, 285.535, 274.783)), (' D 419  LYS  N  ', ' D 424  LEU HD22', -0.627, (238.871, 252.293, 357.324)), (' B 542  ASN  OD1', ' B 547  THR  HA ', -0.622, (306.647, 285.98, 274.984)), (' A 103  GLY  HA3', ' A 120  VAL  HA ', -0.612, (224.781, 282.284, 299.928)), (' D 320  LEU HD23', ' D 555  PHE  CD2', -0.608, (261.214, 260.254, 351.848)), (' C 391  CYS  HA ', ' C 525  CYS  HA ', -0.607, (254.355, 300.983, 291.47)), (' A 454  ARG  HG3', ' A 491  PRO  HB2', -0.606, (295.055, 252.919, 343.087)), (' A  97  LYS  HG3', ' A 187  LYS  CG ', -0.601, (211.334, 278.767, 285.194)), (' C 906  PHE  HB3', ' C 911  VAL  HB ', -0.597, (274.44, 271.472, 206.291)), (' A 907  ASN HD21', ' A 913  GLN  HB3', -0.596, (255.869, 266.228, 206.307)), (' B1076  THR  HB ', ' B1097  SER  HB3', -0.596, (291.483, 255.124, 196.761)), (' B 822  LEU HD21', ' B 938  LEU HD13', -0.595, (276.091, 242.236, 239.473)), (' A 328  ARG HH11', ' A 329  PHE  H  ', -0.594, (268.263, 237.124, 295.009)), (' A 106  PHE  HB2', ' A 117  LEU  HB3', -0.593, (233.852, 279.92, 302.265)), (' A 391  CYS  HA ', ' A 525  CYS  HA ', -0.588, (279.089, 248.706, 306.922)), (' A 129  LYS  HG2', ' A 169  GLU  HG3', -0.586, (230.083, 290.93, 307.008)), (' A1035  GLY  HA3', ' C1040  VAL HG21', -0.584, (264.341, 272.403, 219.003)), (' A 328  ARG  NH1', ' A 329  PHE  HB3', -0.582, (267.778, 236.003, 295.868)), (' A 895  GLN  NE2', ' C1074  ASN  OD1', -0.582, (259.606, 286.264, 204.703)), (' A 142  GLY  HA3', ' A 156  GLU  HB2', -0.578, (212.512, 280.305, 308.918)), (' E 226  VAL HG13', ' E 516  TYR  CE1', -0.577, (327.548, 292.013, 363.561)), (' D 362  THR HG23', ' D 368  ASP  HB3', -0.576, (251.743, 241.512, 362.938)), (' D 320  LEU HD22', ' D 555  PHE  CE2', -0.575, (262.754, 258.848, 351.198)), (' A 701  ALA  HB3', ' B 787  GLN HE22', -0.574, (246.514, 246.205, 234.037)), (' C 103  GLY  HA3', ' C 120  VAL  HA ', -0.574, (304.988, 327.76, 277.493)), (' C 951  VAL  O  ', ' C 955  ASN  ND2', -0.574, (286.486, 279.847, 246.505)), (' A 442  ASP  HB3', ' A 509  ARG HH21', -0.573, (280.558, 237.071, 335.518)), (' D 557  MET  HG3', ' D 569  ALA  HB1', -0.571, (266.059, 267.318, 359.204)), (' B 379  CYS  HA ', ' B 432  CYS  HA ', -0.571, (312.049, 296.983, 306.277)), (' D 271  TRP  NE1', ' D 502  SER  O  ', -0.569, (264.529, 248.743, 387.81)), (' D 457  GLU  HG2', ' D 513  ILE HD13', -0.568, (268.156, 263.447, 379.751)), (' D 419  LYS  CB ', ' D 424  LEU  CD2', -0.567, (236.93, 253.446, 356.547)), (' D 233  ILE  CG1', ' D 581  VAL HG21', -0.565, (255.831, 270.91, 378.005)), (' B 126  VAL  HB ', ' B 172  SER  HB2', -0.564, (297.489, 231.02, 301.227)), (' E 239  HIS  O  ', ' E 599  ASN  ND2', -0.564, (342.589, 277.409, 369.059)), (' C 295  PRO  HB2', ' C 608  VAL HG21', -0.561, (275.574, 309.184, 249.08)), (' D 234  LYS  NZ ', ' D 484  ILE  O  ', -0.56, (255.436, 266.36, 387.834)), (' B 391  CYS  HA ', ' B 525  CYS  HA ', -0.556, (307.882, 299.624, 290.915)), (' D  55  THR HG22', ' D  57  GLU  H  ', -0.556, (276.253, 225.79, 364.873)), (' E 152  MET  O  ', ' E 161  ARG  NH2', -0.555, (354.568, 292.085, 364.953)), (' A 379  CYS  HA ', ' A 432  CYS  HA ', -0.554, (275.062, 253.814, 322.659)), (' C1047  TYR  HB2', ' C1067  TYR  HB3', -0.553, (274.092, 275.394, 213.119)), (' B 598  ILE HD11', ' B 611  LEU HD22', -0.553, (302.738, 259.926, 251.299)), (' D 418  LEU  O  ', ' D 424  LEU  HB2', -0.552, (238.876, 250.446, 356.951)), (' D 320  LEU HD13', ' D 380  GLN  HB3', -0.552, (261.832, 256.362, 354.252)), (' A 729  VAL HG11', ' A 782  PHE  HE2', -0.549, (259.652, 281.259, 236.241)), (' A 394  ASN  HB2', ' A 516  GLU  HB3', -0.549, (287.774, 252.112, 314.147)), (' A  97  LYS  HB2', ' A 186  PHE  HA ', -0.548, (212.697, 276.323, 286.21)), (' C 379  CYS  HA ', ' C 432  CYS  HA ', -0.546, (265.099, 292.17, 298.873)), (' A 454  ARG  NH2', ' A 469  SER  O  ', -0.545, (298.269, 250.948, 338.944)), (' B 561  PRO  HA ', ' B 577  ARG HH12', -0.544, (312.132, 303.541, 264.865)), (' D 318  VAL  O  ', ' D 551  GLY  HA3', -0.543, (255.031, 261.615, 350.142)), (' E 217  TYR  OH ', ' E 225  ASP  OD2', -0.538, (318.758, 294.236, 361.185)), (' D 116  LEU HD11', ' D 187  LYS  HE2', -0.537, (281.29, 251.837, 383.078)), (' A 957  GLN  OE1', ' B 765  ARG  NH1', -0.536, (256.467, 272.987, 261.652)), (' C 410  ILE HD13', ' C 419  ALA  HB2', -0.536, (265.656, 281.044, 306.956)), (' A1090  PRO  O  ', ' B 913  GLN  NE2', -0.535, (266.426, 247.877, 205.286)), (' B 454  ARG  NH2', ' B 469  SER  O  ', -0.532, (310.605, 322.408, 319.309)), (' D 475  LYS  NZ ', ' D 495  GLU  OE2', -0.531, (269.982, 258.494, 404.28)), (' E 247  LYS  HG2', ' E 282  THR HG22', -0.53, (352.301, 280.289, 365.507)), (' E  55  THR HG22', ' E  57  GLU  H  ', -0.529, (351.01, 318.264, 333.919)), (' B1052  PHE  HB2', ' B1063  LEU  HB2', -0.527, (270.919, 244.995, 231.17)), (' D 365  THR  OG1', ' D 368  ASP  OD1', -0.523, (249.697, 240.599, 366.627)), (' A  56  LEU HD12', ' A  57  PRO  HD2', -0.521, (235.561, 268.476, 284.044)), (' A 147  LYS  O  ', ' A 150  LYS  NZ ', -0.521, (195.289, 286.446, 302.701)), (' D 303  ASP  O  ', ' D 305  GLN  N  ', -0.52, (251.554, 237.055, 355.773)), (' C 216  LEU HD12', ' C 217  PRO  HD2', -0.52, (295.883, 326.086, 257.568)), (' B  56  LEU HD12', ' B  57  PRO  HD2', -0.52, (306.719, 246.453, 279.687)), (' B 440  ASN  C  ', ' B 442  ASP  N  ', -0.518, (333.147, 309.72, 312.187)), (' B 985  ASP  N  ', ' B 985  ASP  OD1', -0.518, (272.029, 270.33, 295.794)), (' C1088  HIS  HB3', ' C1120  THR  HB ', -0.517, (255.411, 266.098, 193.805)), (' D 152  MET  O  ', ' D 161  ARG  NH2', -0.516, (250.625, 247.728, 388.826)), (' C 726  ILE  HB ', ' C 947  LYS  HD3', -0.516, (281.921, 282.063, 233.152)), (' C 742  ILE  O  ', ' C1000  ARG  NH1', -0.515, (291.924, 278.368, 270.975)), (' A 598  ILE HD11', ' A 611  LEU HD22', -0.515, (248.069, 253.483, 260.167)), (' D 529  LEU  HG ', ' D 550  ALA  HB1', -0.515, (253.923, 265.195, 355.369)), (' A  34  ARG  HG3', ' A 216  LEU HD13', -0.514, (226.391, 272.45, 280.898)), (' A 274  THR  HB ', ' A 291  CYS  HB2', -0.513, (244.855, 268.872, 275.338)), (' E 579  MET  O  ', ' E 580  ASN  OD1', -0.509, (320.325, 285.812, 360.576)), (' A 328  ARG  NE ', ' A 581  THR  OG1', -0.506, (269.381, 235.081, 292.46)), (' E 455  MET  HG2', ' E 484  ILE HD12', -0.505, (334.497, 294.892, 372.563)), (' E 144  LEU  HG ', ' E 145  GLU  HG3', -0.503, (351.593, 302.099, 357.98)), (' D 320  LEU  HB3', ' D 321  PRO  HD2', -0.502, (261.219, 256.972, 350.604)), (' D 392  LEU  HA ', ' D 562  LYS  HD3', -0.499, (277.547, 260.033, 359.728)), (' A 328  ARG  NH1', ' A 329  PHE  O  ', -0.498, (269.355, 236.038, 295.686)), (' A  97  LYS  HE3', ' A 187  LYS  CD ', -0.496, (209.667, 279.072, 285.04)), (' C 992  GLN  OE1', ' C 995  ARG  NH2', -0.495, (284.586, 285.077, 281.546)), (' B1028  LYS  NZ ', ' B1042  PHE  O  ', -0.495, (273.835, 258.517, 230.73)), (' B  68  ILE  HA ', ' B 262  ALA  HA ', -0.494, (319.545, 228.276, 289.754)), (' B 985  ASP  HB2', ' B 987  PRO  HD2', -0.494, (269.157, 271.646, 296.593)), (' C 567  ARG  NH1', ' C 573  THR  OG1', -0.493, (252.483, 293.169, 275.64)), (' D 189  GLU  OE1', ' D 192  ARG  NH1', -0.493, (288.872, 261.112, 388.264)), (' C 357  ARG  NH2', ' C 394  ASN  OD1', -0.492, (246.719, 292.674, 295.968)), (' D 144  LEU  HG ', ' D 145  GLU  HG3', -0.491, (260.852, 241.654, 384.109)), (' B 981  LEU HD21', ' B 993  ILE HD11', -0.491, (268.888, 267.197, 288.814)), (' C 353  TRP  HZ3', ' C 355  ARG  HB2', -0.491, (251.293, 285.968, 306.151)), (' A1048  HIS  NE2', ' A1051  SER  OG ', -0.491, (256.716, 270.813, 224.441)), (' B 458  LYS  NZ ', ' B 471  GLU  OE1', -0.49, (304.733, 323.83, 322.73)), (' E  82  MET  N  ', ' E  82  MET  SD ', -0.49, (311.204, 322.984, 347.154)), (' B  89  GLY  HA2', ' B 195  LYS  HG2', -0.489, (300.813, 247.049, 288.535)), (' A1056  ALA  HB2', ' A1061  VAL HG23', -0.488, (252.091, 278.405, 236.009)), (' B 102  ARG HH21', ' B 122  ASN  HA ', -0.487, (306.426, 227.898, 301.921)), (' D 414  THR HG22', ' D 416  LYS  H  ', -0.487, (241.501, 258.071, 360.85)), (' B 446  GLY  O  ', ' E  42  GLN  NE2', -0.486, (333.593, 315.646, 327.865)), (' B1041  ASP  HB2', ' C1030  SER  HB3', -0.486, (280.389, 261.574, 226.928)), (' E 414  THR HG22', ' E 416  LYS  H  ', -0.485, (338.761, 274.362, 344.406)), (' A 725  GLU  OE2', ' A1028  LYS  NZ ', -0.485, (258.977, 268.309, 234.092)), (' E 353  LYS  H  ', ' E 393  ARG HH12', -0.484, (327.125, 305.551, 333.041)), (' A 973  ILE  O  ', ' A 973  ILE HG22', -0.484, (260.225, 286.675, 284.916)), (' C 822  LEU HD21', ' C 938  LEU HD13', -0.484, (289.717, 283.868, 227.176)), (' E 116  LEU HD11', ' E 187  LYS  HE2', -0.483, (332.914, 316.824, 360.844)), (' B  21  ARG  NH2', ' B  79  PHE  O  ', -0.482, (323.139, 237.426, 297.497)), (' A 762  GLN HE22', ' C 957  GLN HE22', -0.482, (282.432, 285.397, 256.358)), (' C 938  LEU HD22', ' C 945  LEU HD21', -0.481, (287.155, 285.243, 228.471)), (' C 763  LEU HD22', ' C1008  VAL HG21', -0.48, (284.029, 271.003, 261.252)), (' D 419  LYS  CG ', ' D 424  LEU HD21', -0.48, (236.545, 253.731, 357.449)), (' D 358  ILE HD11', ' D 379  ILE HG13', -0.478, (262.087, 247.131, 357.552)), (' A 703  ASN HD21', ' B 787  GLN  HB3', -0.477, (249.915, 245.801, 231.915)), (' D 539  LEU  HB2', ' D 587  TYR  HD1', -0.476, (247.757, 264.673, 367.008)), (' B 145  TYR  HB3', ' B 247  SER  HA ', -0.474, (319.989, 217.703, 301.724)), (' A1030  SER  HB3', ' C1041  ASP  HB2', -0.474, (267.63, 275.879, 224.29)), (' A 854  LYS  HG2', ' A 859  THR  HA ', -0.474, (260.004, 293.03, 257.134)), (' A 328  ARG HH12', ' A 329  PHE  HB3', -0.473, (267.942, 235.553, 296.147)), (' B 103  GLY  HA3', ' B 120  VAL  HA ', -0.473, (306.135, 234.566, 300.175)), (' D  85  LEU  O  ', ' D  94  LYS  NZ ', -0.472, (287.934, 270.059, 363.684)), (' C 555  SER  HB2', ' C 586  ASP  HB2', -0.47, (244.362, 300.663, 268.362)), (' D 145  GLU  HG2', ' D 149  ASN  HB2', -0.47, (257.727, 241.505, 383.53)), (' C 490  PHE  O  ', ' C 493  GLN  NE2', -0.469, (262.397, 271.438, 322.815)), (' E 189  GLU  HA ', ' E 192  ARG  HE ', -0.469, (323.286, 318.545, 367.108)), (' A 854  LYS  HE2', ' A 860  VAL  H  ', -0.468, (259.119, 293.049, 255.07)), (' C  24  LEU HD12', ' C  78  ARG  HD2', -0.467, (290.229, 342.053, 266.756)), (' A  21  ARG  NH1', ' A  80  ASP  OD2', -0.467, (218.467, 265.498, 306.964)), (' B 119  ILE HG12', ' B 128  ILE HG23', -0.467, (299.643, 238.725, 301.304)), (' B 996  LEU  HB3', ' B1000  ARG HH12', -0.465, (272.661, 265.712, 279.892)), (' A 744  GLY  C  ', ' A 746  SER  N  ', -0.465, (266.703, 298.963, 273.232)), (' B 259  THR HG22', ' B 261  GLY  H  ', -0.465, (320.8, 224.984, 295.133)), (' D 226  VAL HG13', ' D 516  TYR  CE1', -0.464, (263.001, 267.994, 378.742)), (' B  31  SER  HA ', ' B 216  LEU HD12', -0.463, (309.624, 238.637, 276.883)), (' C 593  GLY  HA2', ' C 614  ASP  HB2', -0.463, (261.473, 300.839, 256.666)), (' A 152  TRP  O  ', ' A 153  MET  HG3', -0.461, (208.107, 289.801, 302.652)), (' A 717  ASN  OD1', ' A 718  PHE  N  ', -0.461, (244.065, 257.711, 215.481)), (' A 458  LYS  HE2', ' A 474  GLN  H  ', -0.46, (301.279, 258.656, 345.397)), (' D 267  LEU HD11', ' D 487  VAL HG11', -0.459, (255.312, 255.489, 392.158)), (' B1033  VAL  HA ', ' B1051  SER  HB2', -0.459, (267.485, 250.397, 228.959)), (' C 985  ASP  N  ', ' C 985  ASP  OD1', -0.458, (291.535, 282.14, 289.747)), (' D 419  LYS  HG2', ' D 424  LEU  CD2', -0.458, (236.836, 253.02, 357.501)), (' E 542  CYS  SG ', ' E 543  ASP  N  ', -0.458, (331.661, 275.598, 344.523)), (' D 482  ARG  O  ', ' D 606  TRP  NE1', -0.458, (253.906, 265.714, 393.489)), (' C 346  ARG HH21', ' C 450  ASN  HB3', -0.458, (255.34, 287.112, 323.025)), (' A 204  TYR  HA ', ' A 225  PRO  HA ', -0.458, (233.399, 284.631, 287.431)), (' A 328  ARG HH11', ' A 329  PHE  N  ', -0.457, (268.19, 237.495, 295.592)), (' E 423  LEU  C  ', ' E 423  LEU HD12', -0.457, (346.093, 276.642, 336.525)), (' E 556  ASN  O  ', ' E 560  LEU  HG ', -0.456, (317.454, 293.215, 341.74)), (' C 985  ASP  HB2', ' C 987  PRO  HD2', -0.456, (292.795, 279.363, 291.124)), (' C  94  SER  HA ', ' C 265  TYR  HA ', -0.454, (296.604, 329.156, 265.461)), (' B1142  GLN  HB3', ' B1143  PRO  HD3', -0.453, (273.575, 251.909, 180.498)), (' A 794  ILE HG22', ' A 796  ASP  H  ', -0.453, (243.829, 284.856, 210.924)), (' B 364  ASP  HB2', ' B 527  PRO  HG2', -0.453, (317.925, 298.197, 289.478)), (' B 902  MET  HG3', ' B 916  LEU HD11', -0.452, (269.93, 243.556, 215.822)), (' C1048  HIS  NE2', ' C1051  SER  OG ', -0.451, (280.919, 272.049, 221.117)), (' B  68  ILE HG12', ' B  70  VAL  H  ', -0.451, (323.412, 226.496, 288.991)), (' A 351  TYR  OH ', ' A 469  SER  O  ', -0.451, (298.479, 249.497, 337.906)), (' C 287  ASP  OD1', ' C 288  ALA  N  ', -0.45, (292.569, 310.063, 253.386)), (' A 822  LEU HD21', ' A 938  LEU HD13', -0.45, (245.4, 275.507, 235.62)), (' E 529  LEU  HG ', ' E 550  ALA  HB1', -0.449, (324.953, 281.097, 342.316)), (' B  24  LEU  HB2', ' B  78  ARG  HD2', -0.449, (324.803, 235.741, 288.16)), (' D 481  LYS  O  ', ' D 486  GLY  N  ', -0.449, (255.484, 262.074, 392.264)), (' A 822  LEU HD22', ' A 945  LEU HD11', -0.449, (246.9, 276.813, 238.934)), (' A  68  ILE HG12', ' A  70  VAL  H  ', -0.448, (209.206, 267.265, 295.041)), (' C 276  LEU  HB3', ' C 289  VAL  HB ', -0.448, (288.388, 305.789, 254.55)), (' A 903  ALA  HA ', ' A 916  LEU HD13', -0.447, (251.98, 268.22, 209.965)), (' E 557  MET  HB2', ' E 569  ALA  HB1', -0.447, (320.214, 292.45, 346.418)), (' C 559  PHE  HB2', ' C 577  ARG HH21', -0.445, (239.277, 296.592, 277.33)), (' A 902  MET  HG3', ' A 916  LEU HD11', -0.444, (250.098, 268.934, 211.612)), (' A 983  ARG  HG3', ' A 984  LEU  HG ', -0.444, (265.233, 292.525, 286.993)), (' C 560  LEU  O  ', ' C 577  ARG  NH2', -0.444, (238.439, 295.747, 279.402)), (' A 493  GLN HE22', ' D  31  LYS  HD3', -0.443, (291.903, 251.67, 350.506)), (' A 295  PRO  HB2', ' A 608  VAL HG21', -0.442, (241.299, 258.745, 267.158)), (' D 177  ARG  HB3', ' D 178  PRO  HD3', -0.442, (274.885, 246.357, 397.748)), (' C1050  MET  N  ', ' C1050  MET  SD ', -0.441, (282.016, 272.043, 215.68)), (' C 821  LEU HD21', ' C 939  SER  HB3', -0.441, (293.379, 288.23, 225.486)), (' C1082  CYS  HB3', ' C1134  ASN HD22', -0.44, (246.398, 270.911, 191.027)), (' B 770  ILE HD11', ' B1012  LEU HD23', -0.439, (266.931, 266.871, 255.965)), (' C 108  THR  HA ', ' C 236  THR  HB ', -0.439, (289.88, 322.217, 285.308)), (' C 762  GLN  HA ', ' C 765  ARG  HE ', -0.439, (283.98, 262.625, 262.173)), (' A 126  VAL  HB ', ' A 172  SER  HB3', -0.439, (225.393, 291.208, 297.778)), (' C1056  ALA  HB2', ' C1061  VAL HG23', -0.438, (289.063, 278.29, 231.254)), (' B 719  THR HG23', ' B1070  ALA  HB2', -0.438, (285.609, 244.116, 217.287)), (' B 105  ILE HD11', ' B 239  GLN  HB3', -0.437, (312.081, 242.11, 300.669)), (' D 302  TRP  CH2', ' D 423  LEU HD23', -0.436, (244.152, 244.357, 356.667)), (' A 195  LYS  HE2', ' A 204  TYR  HE1', -0.436, (238.103, 280.453, 288.619)), (' B 396  TYR  HB2', ' B 514  SER  HB3', -0.436, (308.73, 308.074, 302.632)), (' A 880  GLY  O  ', ' A 885  GLY  N  ', -0.435, (257.636, 280.077, 216.061)), (' C 105  ILE HD11', ' C 239  GLN  HB3', -0.435, (295.75, 329.836, 280.656)), (' E 201  ASP  OD1', ' E 204  ARG  NH2', -0.434, (321.274, 305.596, 366.475)), (' B 185  ASN  H  ', ' B 185  ASN HD22', -0.434, (314.78, 220.215, 281.857)), (' A  97  LYS  HE3', ' A 187  LYS  HG3', -0.434, (210.104, 278.165, 285.0)), (' D 394  ASN  HB3', ' D 562  LYS  HD2', -0.433, (275.584, 258.962, 362.243)), (' A 108  THR  HA ', ' A 236  THR  HB ', -0.432, (237.861, 271.822, 305.282)), (' A 353  TRP  HH2', ' A 355  ARG HH21', -0.432, (291.356, 250.706, 325.186)), (' E 263  PRO  HD2', ' E 266  LEU HD12', -0.432, (352.01, 289.619, 373.078)), (' D 107  VAL HG12', ' D 190  MET  HG2', -0.431, (287.749, 256.67, 379.809)), (' E  29  LEU HD11', ' E  93  VAL HG13', -0.43, (311.705, 310.182, 340.077)), (' A1115  ILE HG22', ' A1137  VAL HG13', -0.43, (258.261, 244.321, 195.118)), (' B 326  ILE  O  ', ' B 326  ILE HG13', -0.429, (314.263, 285.767, 274.45)), (' D 144  LEU  O  ', ' D 148  LEU  N  ', -0.429, (257.8, 239.319, 386.881)), (' E 456  LEU HD22', ' E 512  PHE  HD1', -0.429, (336.244, 300.566, 363.345)), (' A 973  ILE  CG2', ' A 973  ILE  O  ', -0.428, (260.413, 286.493, 284.908)), (' A  94  SER  HA ', ' A 265  TYR  HA ', -0.428, (222.018, 272.823, 289.993)), (' A1142  GLN  HB3', ' A1143  PRO  HD3', -0.427, (256.48, 246.755, 185.25)), (' C 342  PHE  HZ ', ' C 513  LEU HD11', -0.427, (258.61, 297.326, 304.435)), (' A 105  ILE HD11', ' A 239  GLN  HB3', -0.427, (227.744, 274.306, 304.62)), (' E 233  ILE  O  ', ' E 233  ILE HG22', -0.426, (333.384, 284.312, 366.804)), (' C 887  THR HG21', ' C 894  LEU HD12', -0.426, (285.618, 256.078, 212.991)), (' A1041  ASP  HB2', ' B1030  SER  HB3', -0.426, (261.461, 259.323, 230.953)), (' E 539  LEU  HB2', ' E 587  TYR  HD1', -0.425, (332.835, 277.816, 352.837)), (' D 108  LEU HD13', ' D 112  LYS  HE2', -0.425, (289.341, 253.855, 385.122)), (' D 526  GLN  NE2', ' D 530  CYS  SG ', -0.424, (249.258, 264.291, 361.31)), (' D 239  HIS  HB3', ' D 595  LEU  HB3', -0.423, (242.599, 266.56, 383.294)), (' A  97  LYS  HE2', ' A 187  LYS  CE ', -0.423, (208.159, 279.328, 285.994)), (' A 985  ASP  N  ', ' A 985  ASP  OD1', -0.423, (270.288, 295.426, 288.687)), (' D 148  LEU HD22', ' D 164  ALA  HB1', -0.423, (255.968, 240.77, 392.561)), (' D  53  ASN  OD1', ' D  55  THR  OG1', -0.422, (271.239, 225.568, 363.148)), (' B 193  VAL  HB ', ' B 204  TYR  HB2', -0.422, (298.764, 240.504, 287.285)), (' B 287  ASP  OD1', ' B 288  ALA  N  ', -0.422, (296.772, 241.399, 269.525)), (' A  91  TYR  N  ', ' A 268  GLY  O  ', -0.421, (233.003, 271.966, 290.08)), (' D 392  LEU HD13', ' D 563  SER  HB3', -0.42, (276.909, 263.107, 355.898)), (' D 320  LEU HD21', ' D 555  PHE  CD2', -0.42, (261.961, 260.325, 352.908)), (' B 196  ASN  HB2', ' B 201  PHE  HD1', -0.42, (299.443, 246.823, 295.986)), (' B 886  TRP  HB3', ' B 905  ARG HH22', -0.42, (262.353, 252.01, 222.609)), (' D 511  SER  O  ', ' D 514  ARG  NH1', -0.42, (269.084, 255.322, 376.485)), (' D 423  LEU  C  ', ' D 423  LEU HD12', -0.42, (239.505, 246.642, 358.114)), (' B 815  ARG  HB3', ' B 819  GLU  HB2', -0.42, (266.581, 238.942, 242.187)), (' D 396  ALA  HB1', ' D 566  TRP  HB3', -0.42, (269.768, 266.134, 364.899)), (' B  64  TRP  HE1', ' B 264  ALA  HB1', -0.419, (315.887, 234.171, 284.289)), (' E 123  MET  HE2', ' E 507  SER  HA ', -0.418, (340.934, 311.836, 361.907)), (' A  53  ASP  OD1', ' A  54  LEU  N  ', -0.417, (243.481, 275.89, 284.869)), (' B 355  ARG HH22', ' B 464  PHE  HB3', -0.417, (304.979, 311.988, 307.198)), (' B 597  VAL HG22', ' B 599  THR HG23', -0.417, (300.99, 253.242, 256.544)), (' A 976  VAL HG12', ' A 978  ASN  H  ', -0.417, (261.927, 295.248, 277.354)), (' A 357  ARG HH12', ' B 167  THR  HA ', -0.417, (294.354, 246.369, 311.166)), (' D 529  LEU HD21', ' D 554  LEU HD22', -0.416, (255.902, 262.809, 357.199)), (' C  91  TYR  N  ', ' C 268  GLY  O  ', -0.416, (291.396, 320.628, 269.612)), (' B1105  THR  OG1', ' B1106  GLN  N  ', -0.415, (280.22, 251.888, 203.358)), (' B 378  LYS  HB2', ' B 378  LYS  HE2', -0.415, (314.692, 296.994, 311.107)), (' A 874  THR HG21', ' A1055  SER  HB3', -0.414, (253.723, 283.881, 232.124)), (' D 526  GLN HE22', ' D 544  ILE HD11', -0.413, (250.058, 262.495, 360.209)), (' C  53  ASP  HB3', ' C  55  PHE  CE2', -0.412, (290.979, 307.391, 265.872)), (' A 985  ASP  HB2', ' A 987  PRO  HD2', -0.412, (273.143, 297.465, 287.843)), (' E 424  LEU  HG ', ' E 425  SER  H  ', -0.411, (347.004, 272.44, 339.138)), (' C 905  ARG  HA ', ' C1036  GLN HE22', -0.411, (277.495, 266.937, 211.971)), (' A  97  LYS  HE3', ' A 187  LYS  CG ', -0.411, (209.866, 278.691, 284.79)), (' D 369  PHE  O  ', ' D 373  HIS  ND1', -0.411, (251.122, 248.295, 360.987)), (' B 721  SER  OG ', ' B1066  THR  OG1', -0.411, (280.417, 247.835, 225.144)), (' E 233  ILE HG12', ' E 581  VAL HG21', -0.411, (328.886, 284.453, 365.029)), (' A 401  VAL HG22', ' A 509  ARG  HG2', -0.41, (281.287, 241.39, 333.785)), (' E 450  LEU  HB3', ' E 451  PRO  HD3', -0.409, (336.163, 288.895, 364.628)), (' C 458  LYS  HE3', ' C 474  GLN  HG2', -0.408, (256.02, 262.168, 315.613)), (' A 982  SER  HB2', ' C 390  LEU HD21', -0.408, (260.885, 298.729, 285.932)), (' D 503  LEU HD23', ' D 506  VAL HG23', -0.407, (267.53, 252.864, 384.419)), (' B  28  TYR  HB3', ' B  61  ASN HD21', -0.407, (318.414, 243.506, 277.907)), (' A 387  LEU  C  ', ' A 387  LEU HD12', -0.407, (273.219, 249.538, 313.692)), (' D 184  VAL HG13', ' D 464  PHE  HD1', -0.407, (277.996, 258.872, 388.963)), (' A 540  ASN  ND2', ' A 549  THR  OG1', -0.407, (264.575, 250.056, 286.144)), (' C 226  LEU  HG ', ' C 227  VAL HG12', -0.406, (307.665, 315.382, 273.843)), (' A  35  GLY  HA3', ' A  56  LEU  HB3', -0.406, (233.607, 272.763, 282.648)), (' A 226  LEU  HG ', ' A 227  VAL HG12', -0.405, (232.135, 289.287, 292.104)), (' E 462  MET  HB3', ' E 467  GLU  HB2', -0.404, (328.271, 305.187, 375.929)), (' C 356  LYS  HB3', ' C 397  ALA  HB3', -0.404, (251.799, 293.336, 307.097)), (' A  89  GLY  HA2', ' A 195  LYS  HG2', -0.404, (238.245, 276.07, 290.923)), (' E 231  GLU  HA ', ' E 234  LYS  HE2', -0.404, (329.096, 285.521, 372.325)), (' B 108  THR  OG1', ' B 234  ASN  O  ', -0.404, (305.241, 251.944, 301.609)), (' E 294  THR HG23', ' E 365  THR  HA ', -0.404, (353.296, 284.568, 339.975)), (' A 716  THR  OG1', ' A1071  GLN  O  ', -0.403, (243.712, 251.495, 214.456)), (' E 103  ASN  HB3', ' E 107  VAL  HB ', -0.403, (321.393, 320.195, 356.291)), (' D 580  ASN  OD1', ' D 581  VAL  N  ', -0.403, (256.859, 273.77, 372.277)), (' B 333  THR  O  ', ' B 333  THR HG22', -0.402, (321.569, 305.644, 281.94)), (' D 438  PHE  HA ', ' D 441  LYS  HE3', -0.402, (241.948, 255.429, 372.104)), (' C 310  LYS  HG3', ' C 600  PRO  HA ', -0.402, (276.712, 303.602, 239.263)), (' B 424  LYS  NZ ', ' B 425  LEU  O  ', -0.401, (302.804, 306.147, 315.896)), (' E 233  ILE HD12', ' E 584  LEU HD22', -0.401, (331.25, 283.474, 362.591)), (' B 490  PHE  CE1', ' B 492  LEU  HB2', -0.401, (317.111, 322.424, 323.813)), (' C 882  ILE HG13', ' C 883  THR HG23', -0.401, (293.618, 266.362, 214.096)), (' C  85  PRO  HA ', ' C 237  ARG  HG2', -0.4, (287.524, 324.994, 280.77)), (' A 490  PHE  HE1', ' A 492  LEU  HB2', -0.4, (295.661, 246.628, 344.511))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
